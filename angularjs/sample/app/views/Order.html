<div class="col-lg-12 col-md-12" ng-controller="OrderController" ng-init>
    <h3 class="text-center">Orders</h3>
    <form style="position:relative;z-index:30" class="form-inline pull-right" role="form">
        <div class="form-group">
            <input type="text" ng-model="searchValue" class="form-control" placeholder="Search">
        </div>
    </form>
    <div style="position:relative;z-index:20" class="table-responsive">
        <table class="table table-striped table-bordered">
            <thead>
                <tr>
                    <th ng-click="sort('id')">
                        Order Id
                        <span class="glyphicon sort-icon" ng-show="sortKey=='id'" ng-class="{'glyphicon-chevron-up':reverse,'glyphicon-chevron-down':!reverse}"></span>
                    </th>
                    <th ng-click="sort('goomo_order_id')">
                        Goomo Order Id
                        <span class="glyphicon sort-icon" ng-show="sortKey=='goomo_order_id'" ng-class="{'glyphicon-chevron-up':reverse,'glyphicon-chevron-down':!reverse}"></span>
                    </th>
                    <th ng-click="sort('draft_id')">
                        Draft Id
                        <span class="glyphicon sort-icon" ng-show="sortKey=='draft_id'" ng-class="{'glyphicon-chevron-up':reverse,'glyphicon-chevron-down':!reverse}"></span>
                    </th>
                    <th ng-click="sort('booking_amount')">
                        Package amount
                        <span class="glyphicon sort-icon" ng-show="sortKey=='booking_amount'" ng-class="{'glyphicon-chevron-up':reverse,'glyphicon-chevron-down':!reverse}"></span>
                    </th>
                    <th ng-click="sort('tax_amount')">
                        Tax Amount
                        <span class="glyphicon sort-icon" ng-show="sortKey=='tax_amount'" ng-class="{'glyphicon-chevron-up':reverse,'glyphicon-chevron-down':!reverse}"></span>
                    </th>
                    <th ng-click="sort('discount')">
                        Discount
                        <span class="glyphicon sort-icon" ng-show="sortKey=='discount'" ng-class="{'glyphicon-chevron-up':reverse,'glyphicon-chevron-down':!reverse}"></span>
                    </th>
                    <th ng-click="sort('net_amount')">
                        Net Amount
                        <span class="glyphicon sort-icon" ng-show="sortKey=='net_amount'" ng-class="{'glyphicon-chevron-up':reverse,'glyphicon-chevron-down':!reverse}"></span>
                    </th>
                    <th ng-click="sort('pending_amount')">
                        Pending Amount
                        <span class="glyphicon sort-icon" ng-show="sortKey=='pending_amount'" ng-class="{'glyphicon-chevron-up':reverse,'glyphicon-chevron-down':!reverse}"></span>
                    </th>
                    <th ng-click="sort('booking_status')">
                        Booking Status
                        <span class="glyphicon sort-icon" ng-show="sortKey=='booking_status'" ng-class="{'glyphicon-chevron-up':reverse,'glyphicon-chevron-down':!reverse}"></span>
                    </th>
                    <th ng-click="sort('createdAt')">
                        CreatedAt
                        <span class="glyphicon sort-icon" ng-show="sortKey=='createdAt'" ng-class="{'glyphicon-chevron-up':reverse,'glyphicon-chevron-down':!reverse}"></span>
                    </th>
                    <th>Transactions</th>
                    <th>Traveller Details</th>
                    <th>GST Details</th>
                </tr>
            </thead>
            <tbody>
                <tr dir-paginate="order in orders |orderBy:sortKey:reverse|filter:searchValue|itemsPerPage:8">
                    <td>{{ order.id }}</td>
                    <td>{{ order.goomo_order_id }}</td>
                    <td>{{ order.draft_id }}</td>
                    <td>{{ order.booking_amount }}</td>
                    <td>{{ order.tax_amount}} </td>
                    <td>{{ order.discount}} </td>
                    <td>{{ order.net_amount}} </td>
                    <td>{{ order.pending_amount}} </td>
                    <td>{{ order.booking_status}} </td>
                    <td>{{ order.createdAt | date : 'dd,MMM yyyy HH:mm'}} </td>
                    <td class="text-center">
                        <button class="btn btn-sm" ng-click="getTransactions(order.id);toggleModal();">
                            <span class="glyphicon glyphicon-pencil"></span>
                            Transactions
                        </button>
                    </td>
                    <td class="text-center">
                        <button class="btn btn-sm" ng-click="getTravellerDetails(order.id, order.traveller_details);toggleTraveller();">
                            <span class="glyphicon glyphicon-pencil"></span>
                            Travellers Details
                        </button>
                    </td>
                    <td class="text-center">
                        <button class="btn btn-sm" ng-click="getGSTDetails(order.id, order.gst_details);toggleGST();">
                            <span class="glyphicon glyphicon-pencil"></span>
                            GST Details
                        </button>
                    </td>
                </tr>
            </tbody>
        </table>
        <dir-pagination-controls max-size="20" direction-links="true" boundary-links="true">
        </dir-pagination-controls>
    </div>
    <button style="position:relative;z-index:20" class="btn btn-success" ng-click="getMoreOrders();">
        <span class="glyphicon glyphicon-"></span>
        Get More Orders
    </button>
    <modal title="GST Details" dikhao="showGST">
        <form class="form-horizontal" name="myForm">
            <div class="form-group" ng-class="{ 'has-error' : myForm.orders.$invalid && !myForm.orders.$pristine }">
                <label class="col-sm-4 control-label">GST Details:</label>
                <div class="col-sm-4">
                    <textarea class="form-control" rows="4" class="form-control" name="gst_details" ng-model="OrderController.gstDetails" placeholder="GST Details"
                        ng-disabled="info"></textarea>
                </div>
            </div>
        </form>
    </modal>

    <modal title="Traveller Details" dikhao="showTraveller">
        <form class="form-horizontal" name="frmTraveller">
            <div class="form-group">
                <label class="col-sm-4 control-label">Traveller Details:</label>
                <div class="col-sm-4">
                    <textarea class="form-control" rows="4" class="form-control" name="traveller_details" ng-model="OrderController.travellerDetails"
                        placeholder="Traveller Details" ng-disabled="info"></textarea>
                </div>
            </div>
        </form>
    </modal>
    <modal title="Transaction Details" dikhao="showModal">
        <form class="form-horizontal" name="frmTransactions">
            <div class="form-group">
                <div style="position:relative;z-index:20" class="table-responsive" ng-if="transactions.length>0">
                    <table class="table table-striped table-bordered">
                        <thead>
                            <tr>
                                <th ng-click="sort('id')">
                                    Transaction Id
                                    <span class="glyphicon sort-icon" ng-show="sortKey=='id'" ng-class="{'glyphicon-chevron-up':reverse,'glyphicon-chevron-down':!reverse}"></span>
                                </th>
                                <th ng-click="sort('goomo_transaction_id')">
                                    Goomo Transaction Id
                                    <span class="glyphicon sort-icon" ng-show="sortKey=='goomo_transaction_id'" ng-class="{'glyphicon-chevron-up':reverse,'glyphicon-chevron-down':!reverse}"></span>
                                </th>
                                <th ng-click="sort('order_id')">
                                    Order Id
                                    <span class="glyphicon sort-icon" ng-show="sortKey=='order_id'" ng-class="{'glyphicon-chevron-up':reverse,'glyphicon-chevron-down':!reverse}"></span>
                                </th>
                                <th ng-click="sort('draft_id')">
                                    Draft Id
                                    <span class="glyphicon sort-icon" ng-show="sortKey=='draft_id'" ng-class="{'glyphicon-chevron-up':reverse,'glyphicon-chevron-down':!reverse}"></span>
                                </th>
                                <th ng-click="sort('transaction_amount')">
                                    Transaction Amount
                                    <span class="glyphicon sort-icon" ng-show="sortKey=='transaction_amount'" ng-class="{'glyphicon-chevron-up':reverse,'glyphicon-chevron-down':!reverse}"></span>
                                </th>
                                <th ng-click="sort('payment_gateway')">
                                    Payment Gateway
                                    <span class="glyphicon sort-icon" ng-show="sortKey=='payment_gateway'" ng-class="{'glyphicon-chevron-up':reverse,'glyphicon-chevron-down':!reverse}"></span>
                                </th>
                                <th ng-click="sort('status')">
                                    Status
                                    <span class="glyphicon sort-icon" ng-show="sortKey=='status'" ng-class="{'glyphicon-chevron-up':reverse,'glyphicon-chevron-down':!reverse}"></span>
                                </th>
                                <th>
                                    Payment Gateway Response
                                    <span class="glyphicon sort-icon" ng-show="sortKey=='payment_gateway_response'" ng-class="{'glyphicon-chevron-up':reverse,'glyphicon-chevron-down':!reverse}"></span>
                                </th>
                            </tr>
                            <p ng-if="leadQuotations.length==0"></p>
                        </thead>
                        <tbody>
                            <tr ng-repeat="transaction in transactions">
                                <td>{{ transaction.id }}</td>
                                <td>{{ transaction.goomo_transaction_id }}</td>
                                <td>{{ transaction.order_id }}</td>
                                <td>{{ transaction.draft_id }}</td>
                                <td>{{ transaction.transaction_amount }}</td>
                                <td>{{ transaction.payment_gateway}} </td>
                                <td>{{ transaction.status}} </td>
                                <td> <textarea class="form-control" rows="4" class="form-control" ng-model="transaction.payment_gateway_response"
                                        placeholder="Traveller Details" ng-disabled="true"></textarea>
                                </td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>
            <p ng-if="transactions.length==0">No records found</p>
        </form>
    </modal>
</div>